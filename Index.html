<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PAISAR OS - DIVINE EDITION</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            /* TempleOS Palette */
            --bg-color: #ffffff;
            --text-blue: #0000AA;
            --text-red: #AA0000;
            --status-bg: #00AAAA; /* Cyan */
            --status-text: #FFFFFF;
            --monitor-bg: #111;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--monitor-bg);
            font-family: 'VT323', monospace;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: var(--text-blue);
            user-select: none;
        }

        /* Monitor Frame */
        #monitor {
            width: 100%;
            max-width: 800px;
            height: 100%;
            max-height: 600px;
            background-color: var(--bg-color);
            position: relative;
            display: flex;
            flex-direction: column;
            border: 4px solid #555;
            box-shadow: 0 0 30px rgba(0,0,0,0.9);
            overflow: hidden;
        }

        /* CRT Effects */
        .scanlines {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 999;
        }
        
        .flicker {
            animation: flicker 0.15s infinite;
            pointer-events: none;
            position: absolute;
            top:0; left:0; width:100%; height:100%;
            background: rgba(255,255,255,0.02);
            z-index: 998;
        }

        @keyframes flicker {
            0% { opacity: 0.9; }
            50% { opacity: 1.0; }
            100% { opacity: 0.9; }
        }

        /* Top Status Bar */
        #status-bar {
            background-color: var(--status-bg);
            color: var(--status-text);
            padding: 4px 8px;
            display: flex;
            justify-content: space-between;
            font-size: 24px;
            border-bottom: 2px solid #000;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Main Desktop Area */
        #desktop {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            position: relative;
            font-size: 24px;
            line-height: 1.1;
            cursor: text;
        }

        /* Text Styles */
        .red { color: var(--text-red); font-weight: bold; }
        .blue { color: var(--text-blue); }
        .blink { animation: blinker 1s steps(2, start) infinite; }
        @keyframes blinker { 50% { opacity: 0; } }

        /* Command Line */
        .terminal-output {
            white-space: pre-wrap;
            margin-bottom: 10px;
        }
        .input-area {
            display: flex;
            align-items: center;
        }
        .prompt {
            color: var(--text-red);
            margin-right: 8px;
            font-weight: bold;
        }
        input[type="text"] {
            background: transparent;
            border: none;
            color: var(--text-blue);
            font-family: 'VT323', monospace;
            font-size: 24px;
            flex: 1;
            outline: none;
            text-transform: uppercase;
        }

        /* Windows / Apps */
        .window {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 85%;
            height: 70%;
            background: #fff;
            border: 6px double var(--text-blue);
            display: none;
            flex-direction: column;
            z-index: 100;
            box-shadow: 10px 10px 0px rgba(0,0,0,0.5);
        }

        .win-header {
            background: var(--text-blue);
            color: #fff;
            padding: 5px;
            text-align: center;
            font-size: 26px;
            text-transform: uppercase;
        }

        .win-content {
            flex: 1;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* Game Canvas */
        canvas {
            border: 4px solid #000;
            background: #000;
            image-rendering: pixelated;
        }

        /* Mobile Dock */
        #dock {
            background: #AAA;
            padding: 8px;
            display: flex;
            justify-content: space-around;
            border-top: 4px solid #000;
        }
        
        .dock-btn {
            background: var(--text-red);
            color: #fff;
            font-family: 'VT323', monospace;
            font-size: 20px;
            border: 2px solid #000;
            padding: 10px 12px;
            cursor: pointer;
            box-shadow: 3px 3px 0px #000;
            text-transform: uppercase;
        }
        .dock-btn:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0px #000;
        }

    </style>
</head>
<body>

    <div id="monitor">
        <div class="scanlines"></div>
        <div class="flicker"></div>
        
        <!-- Status Bar -->
        <div id="status-bar">
            <span id="clock">00:00:00</span>
            <span>PAISAR OS</span>
            <span>MEM: DIVINE</span>
        </div>

        <!-- Desktop -->
        <div id="desktop" onclick="focusInput()">
            <div class="terminal-output" id="output">
                PAISAR OS V2.0 (C) 2025<br>
                WELCOME TO THE TEMPLE OF PAISAR.<br>
                --------------------------------<br>
                "I wrote this OS to talk to God." - Paisar<br>
                <br>
                TYPE <span class="red">"HELP"</span> FOR COMMANDS.<br>
                <br>
            </div>
            <div class="input-area">
                <span class="prompt">PAISAR:/root></span>
                <input type="text" id="cmdInput" autocomplete="off" autofocus>
            </div>
        </div>

        <!-- GAME WINDOW -->
        <div id="game-window" class="window">
            <div class="win-header">CIA DODGER</div>
            <div class="win-content">
                <canvas id="gameCanvas" width="300" height="200"></canvas>
                <p>TAP LEFT/RIGHT TO AVOID GLOWIES</p>
                <button class="dock-btn" onclick="closeApp('game-window')">ESCAPE</button>
            </div>
        </div>

        <!-- ORACLE WINDOW -->
        <div id="oracle-window" class="window">
            <div class="win-header">THE ORACLE OF PAISAR</div>
            <div class="win-content">
                <div id="oracle-text" style="font-size: 30px; margin-bottom: 20px; color: var(--text-blue);">
                    CONSULTING THE INTELLECT...
                </div>
                <button class="dock-btn" onclick="consultOracle()">ASK AGAIN</button>
                <br>
                <button class="dock-btn" style="background: #555;" onclick="closeApp('oracle-window')">CLOSE</button>
            </div>
        </div>

        <!-- Mobile Dock -->
        <div id="dock">
            <button class="dock-btn" onclick="runCmd('GAME')">ðŸŽ® GAME</button>
            <button class="dock-btn" onclick="runCmd('HYMN')">ðŸŽµ HYMN</button>
            <button class="dock-btn" onclick="runCmd('ORACLE')">ðŸ”® ASK</button>
            <button class="dock-btn" onclick="runCmd('CLS')">ðŸ§¹ CLS</button>
        </div>
    </div>

    <script>
        /* --- AUDIO SYSTEM (Web Audio API) --- */
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function beep(freq = 440, duration = 0.1, type = 'square') {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration);
            osc.stop(audioCtx.currentTime + duration);
        }

        // Procedural Hymn Generator
        function playHymn() {
            printLine("GENERATING DIVINE FREQUENCIES...", true);
            const scale = [220, 246, 261, 293, 329, 349, 392, 440, 523]; // Minor harmonic-ish
            let time = 0;
            for(let i=0; i<12; i++) {
                let note = scale[Math.floor(Math.random() * scale.length)];
                let dur = Math.random() > 0.5 ? 0.2 : 0.4;
                setTimeout(() => beep(note, dur, 'triangle'), time * 1000);
                setTimeout(() => beep(note * 1.5, dur, 'sine'), time * 1000); // Harmony
                time += dur;
            }
        }

        /* --- OS LOGIC --- */
        const outputDiv = document.getElementById('output');
        const cmdInput = document.getElementById('cmdInput');
        const clockDiv = document.getElementById('clock');

        // Clock
        setInterval(() => {
            const now = new Date();
            clockDiv.innerText = now.toLocaleTimeString();
        }, 1000);

        function focusInput() {
            cmdInput.focus();
        }

        function printLine(text, isHtml = false) {
            if(isHtml) {
                outputDiv.innerHTML += text + "<br>";
            } else {
                outputDiv.innerText += text + "\n";
            }
            document.getElementById('desktop').scrollTop = document.getElementById('desktop').scrollHeight;
        }

        function runCmd(cmdOverride = null) {
            let cmd = cmdOverride ? cmdOverride : cmdInput.value.trim().toUpperCase();
            if (!cmdOverride) {
                printLine("PAISAR:/root> " + cmd);
                cmdInput.value = "";
            }

            switch (cmd) {
                case 'HELP':
                    printLine("COMMAND LIST:");
                    printLine(" GAME   - RUN CIA DODGER");
                    printLine(" HYMN   - PLAY HOLY MUSIC");
                    printLine(" ORACLE - ASK PAISAR A QUESTION");
                    printLine(" CLS    - CLEAR SCREEN");
                    printLine(" MAN    - WHO IS PAISAR?");
                    break;
                case 'CLS':
                case 'CLEAR':
                    outputDiv.innerText = "";
                    break;
                case 'HYMN':
                    playHymn();
                    break;
                case 'ORACLE':
                    openOracle();
                    break;
                case 'GAME':
                    startGame();
                    break;
                case 'MAN':
                    printLine("PAISAR IS THE ARCHITECT.");
                    printLine("HE BUILT THIS IN 7 DAYS.");
                    printLine("HE HATES THE CIA.");
                    break;
                case 'CIA':
                    printLine("THEY GLOW IN THE DARK. RUN.");
                    break;
                default:
                    printLine("BAD COMMAND. PAISAR DOES NOT UNDERSTAND.");
                    beep(150, 0.2, 'sawtooth');
            }
        }

        cmdInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') runCmd();
        });

        /* --- ORACLE SYSTEM --- */
        function openOracle() {
            document.getElementById('oracle-window').style.display = 'flex';
            consultOracle();
        }

        function consultOracle() {
            const words = ["YES", "NO", "MAYBE", "KILL IT", "COMPILE", "DIVINE", "GLOWIE", "RUN", "LINUX IS TRASH", "GOD SAYS YES", "MAKE IT 640x480"];
            const choice = words[Math.floor(Math.random() * words.length)];
            document.getElementById('oracle-text').innerText = `"${choice}"`;
            beep(600 + Math.random()*200, 0.3, 'sine');
        }

        /* --- GAME ENGINE (CIA DODGER) --- */
        let gameInterval;
        let gameCanvas = document.getElementById('gameCanvas');
        let ctx = gameCanvas.getContext('2d');
        let playerX = 130;
        let enemies = [];
        let score = 0;
        let isGameRunning = false;

        function startGame() {
            document.getElementById('game-window').style.display = 'flex';
            enemies = [];
            score = 0;
            playerX = 130;
            isGameRunning = true;
            if (gameInterval) clearInterval(gameInterval);
            gameInterval = setInterval(updateGame, 30);
            
            // Touch Controls
            gameCanvas.addEventListener('mousedown', handleInput);
            gameCanvas.addEventListener('touchstart', handleInput, {passive: false});
        }

        function closeApp(id) {
            document.getElementById(id).style.display = 'none';
            if(id === 'game-window') {
                clearInterval(gameInterval);
                isGameRunning = false;
            }
            focusInput();
        }

        function handleInput(e) {
            if(!isGameRunning) return;
            e.preventDefault();
            const rect = gameCanvas.getBoundingClientRect();
            const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
            
            if (x < rect.width / 2) playerX -= 25;
            else playerX += 25;
            
            if(playerX < 0) playerX = 0;
            if(playerX > 270) playerX = 270;
        }

        function updateGame() {
            // Draw Background
            ctx.fillStyle = "#0000AA"; // Blue Background
            ctx.fillRect(0, 0, 300, 200);
            
            // Draw Player (Paisar) - White Box
            ctx.fillStyle = "#FFFFFF";
            ctx.fillRect(playerX, 170, 30, 30);
            // Draw Halo
            ctx.strokeStyle = "yellow";
            ctx.beginPath();
            ctx.arc(playerX + 15, 165, 10, 0, 2*Math.PI);
            ctx.stroke();

            // Spawn Enemies (CIA/Glowies) - Green Boxes
            if (Math.random() < 0.05) {
                enemies.push({x: Math.random() * 270, y: -20});
            }

            ctx.fillStyle = "#00FF00"; // Green Glow
            for (let i = 0; i < enemies.length; i++) {
                let en = enemies[i];
                en.y += 4; // Speed
                ctx.fillRect(en.x, en.y, 30, 20);
                
                // Eyes on Glowies
                ctx.fillStyle = "black";
                ctx.fillRect(en.x + 5, en.y+5, 5, 5);
                ctx.fillRect(en.x + 20, en.y+5, 5, 5);
                ctx.fillStyle = "#00FF00";

                // Collision
                if (en.y > 160 && en.y < 200 && en.x < playerX + 30 && en.x + 30 > playerX) {
                    clearInterval(gameInterval);
                    isGameRunning = false;
                    ctx.fillStyle = "red";
                    ctx.font = "40px VT323";
                    ctx.fillText("CAPTURED", 80, 100);
                    beep(100, 0.5, 'sawtooth');
                }
            }
            
            // Score
            score++;
            ctx.fillStyle = "white";
            ctx.font = "20px VT323";
            ctx.fillText("SCORE: " + score, 10, 20);
        }

        // Boot Sequence
        setTimeout(() => { printLine("LOADING PAISAR KERNEL...", true); }, 500);
        setTimeout(() => { printLine("COMPILING DIVINE INTELLECT...", true); }, 1200);
        setTimeout(() => { printLine("<span class='blink'>SYSTEM READY.</span>", true); beep(880, 0.1); }, 2000);

    </script>
</body>
</html>
