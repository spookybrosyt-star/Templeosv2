<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebOS v1.0</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --taskbar-color: #2d2d2d;
            --window-bg: #222;
            --window-header: #333;
            --accent: #0078d7;
            --text-color: #fff;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Segoe UI', sans-serif;
            background: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1920&auto=format&fit=crop') no-repeat center center fixed;
            background-size: cover;
            height: 100vh;
            user-select: none;
        }

        /* Desktop Icons */
        #desktop {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            height: calc(100vh - 50px);
        }

        .icon {
            width: 80px;
            text-align: center;
            color: white;
            cursor: pointer;
            padding: 10px;
            border-radius: 5px;
            transition: 0.2s;
            text-shadow: 1px 1px 2px black;
        }

        .icon:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .icon span {
            font-size: 40px;
            display: block;
            margin-bottom: 5px;
        }

        /* Taskbar */
        #taskbar {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 45px;
            background: rgba(45, 45, 45, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 9999;
            border-top: 1px solid #444;
        }

        #start-btn {
            background: var(--accent);
            color: white;
            padding: 5px 15px;
            border-radius: 4px;
            margin-right: 15px;
            cursor: pointer;
            font-weight: bold;
        }

        #clock {
            margin-left: auto;
            color: white;
            font-size: 14px;
            margin-right: 20px;
        }

        /* Windows */
        .window {
            position: absolute;
            background: var(--window-bg);
            border: 1px solid #444;
            border-radius: 6px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            min-width: 300px;
            min-height: 200px;
            color: white;
            overflow: hidden;
            animation: popIn 0.2s ease-out;
        }

        @keyframes popIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .window-header {
            background: var(--window-header);
            padding: 8px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            border-bottom: 1px solid #444;
        }

        .window-title {
            font-size: 14px;
            pointer-events: none;
        }

        .window-controls span {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 5px;
            cursor: pointer;
        }

        .close-btn { background: #ff5f56; }
        .min-btn { background: #ffbd2e; }
        .max-btn { background: #27c93f; }

        .window-content {
            flex: 1;
            position: relative;
            background: #1e1e1e;
        }

        /* Terminal Specifics */
        .terminal-body {
            background: black;
            color: #0f0;
            font-family: 'Courier New', monospace;
            padding: 10px;
            height: 100%;
            box-sizing: border-box;
            overflow-y: auto;
            font-size: 14px;
        }
        
        .terminal-input-line {
            display: flex;
        }
        
        .terminal-input {
            background: transparent;
            border: none;
            color: #0f0;
            outline: none;
            flex: 1;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        /* Browser Specifics */
        .browser-nav {
            background: #333;
            padding: 5px;
            display: flex;
            gap: 5px;
        }
        .browser-nav input {
            flex: 1;
            background: #222;
            border: 1px solid #444;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
        }
        .browser-frame {
            width: 100%;
            height: calc(100% - 40px);
            border: none;
            background: white;
        }

        /* Notepad */
        .notepad-area {
            width: 100%;
            height: 100%;
            background: #2b2b2b;
            color: white;
            border: none;
            resize: none;
            padding: 10px;
            box-sizing: border-box;
            outline: none;
            font-family: monospace;
        }

    </style>
</head>
<body>

    <div id="desktop">
        <div class="icon" onclick="openApp('browser')">
            <span>üåê</span>
            <div>Browser</div>
        </div>
        <div class="icon" onclick="openApp('terminal')">
            <span>üíª</span>
            <div>Terminal</div>
        </div>
        <div class="icon" onclick="openApp('notepad')">
            <span>üìù</span>
            <div>Notepad</div>
        </div>
        <div class="icon" onclick="openApp('calc')">
            <span>üßÆ</span>
            <div>Calc</div>
        </div>
        <div class="icon" onclick="location.reload()">
            <span>üîÑ</span>
            <div>Reboot</div>
        </div>
    </div>

    <div id="taskbar">
        <div id="start-btn">Start</div>
        <div id="clock">12:00 PM</div>
    </div>

    <script>
        // System State
        let zIndex = 100;
        
        // Clock Functionality
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Window Management System
        function openApp(type) {
            const id = 'win-' + Date.now();
            const win = document.createElement('div');
            win.classList.add('window');
            win.id = id;
            win.style.zIndex = ++zIndex;
            
            // Random start position
            win.style.top = (50 + Math.random() * 50) + 'px';
            win.style.left = (50 + Math.random() * 50) + 'px';

            let title = "Application";
            let content = "";
            let width = "600px";
            let height = "400px";

            // App Content Logic
            if(type === 'terminal') {
                title = "Terminal";
                content = `
                    <div class="terminal-body" id="term-${id}" onclick="document.getElementById('input-${id}').focus()">
                        <div>WebOS Kernel v1.0 [Simulation]</div>
                        <div>Type 'help' for commands.</div>
                        <br>
                        <div id="history-${id}"></div>
                        <div class="terminal-input-line">
                            <span>root@webos:~$ </span>
                            <input type="text" id="input-${id}" class="terminal-input" autocomplete="off">
                        </div>
                    </div>
                `;
            } else if (type === 'browser') {
                title = "Web Browser";
                width = "800px";
                height = "500px";
                content = `
                    <div style="height:100%; display:flex; flex-direction:column;">
                        <div class="browser-nav">
                            <button onclick="document.getElementById('frame-${id}').src = document.getElementById('url-${id}').value">Go</button>
                            <input type="text" id="url-${id}" value="https://www.wikipedia.org" placeholder="Enter URL (https only)">
                        </div>
                        <iframe id="frame-${id}" class="browser-frame" src="https://www.wikipedia.org"></iframe>
                    </div>
                `;
            } else if (type === 'notepad') {
                title = "Untitled - Notepad";
                content = `<textarea class="notepad-area" placeholder="Type here..."></textarea>`;
            } else if (type === 'calc') {
                title = "Calculator";
                width = "250px";
                height = "350px";
                content = `
                    <div style="padding:10px; height:100%; background:#222; display:flex; flex-direction:column; gap:5px;">
                        <input type="text" id="calc-display-${id}" style="width:100%; padding:10px; margin-bottom:10px; text-align:right;" readonly>
                        <div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:5px; flex:1;">
                            <button onclick="calcInput('${id}', '7')">7</button>
                            <button onclick="calcInput('${id}', '8')">8</button>
                            <button onclick="calcInput('${id}', '9')">9</button>
                            <button onclick="calcInput('${id}', '/')">/</button>
                            <button onclick="calcInput('${id}', '4')">4</button>
                            <button onclick="calcInput('${id}', '5')">5</button>
                            <button onclick="calcInput('${id}', '6')">6</button>
                            <button onclick="calcInput('${id}', '*')">*</button>
                            <button onclick="calcInput('${id}', '1')">1</button>
                            <button onclick="calcInput('${id}', '2')">2</button>
                            <button onclick="calcInput('${id}', '3')">3</button>
                            <button onclick="calcInput('${id}', '-')">-</button>
                            <button onclick="calcInput('${id}', 'C')">C</button>
                            <button onclick="calcInput('${id}', '0')">0</button>
                            <button onclick="calcInput('${id}', '=')">=</button>
                            <button onclick="calcInput('${id}', '+')">+</button>
                        </div>
                    </div>
                `;
            }

            win.style.width = width;
            win.style.height = height;

            win.innerHTML = `
                <div class="window-header" onmousedown="startDrag(event, '${id}')">
                    <span class="window-title">${title}</span>
                    <div class="window-controls">
                        <span class="min-btn"></span>
                        <span class="max-btn" onclick="toggleMaximize('${id}')"></span>
                        <span class="close-btn" onclick="closeWindow('${id}')"></span>
                    </div>
                </div>
                <div class="window-content">${content}</div>
            `;

            document.body.appendChild(win);
            makeDraggable(win);

            // Initialize Terminal Events if needed
            if(type === 'terminal') {
                const input = document.getElementById(`input-${id}`);
                input.focus();
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        handleTerminalCommand(id, this.value);
                        this.value = '';
                    }
                });
            }
        }

        function closeWindow(id) {
            document.getElementById(id).remove();
        }

        function toggleMaximize(id) {
            const win = document.getElementById(id);
            if(win.style.width === '100%') {
                win.style.width = win.dataset.prevWidth;
                win.style.height = win.dataset.prevHeight;
                win.style.top = win.dataset.prevTop;
                win.style.left = win.dataset.prevLeft;
            } else {
                win.dataset.prevWidth = win.style.width;
                win.dataset.prevHeight = win.style.height;
                win.dataset.prevTop = win.style.top;
                win.dataset.prevLeft = win.style.left;
                win.style.width = '100%';
                win.style.height = 'calc(100vh - 45px)';
                win.style.top = '0';
                win.style.left = '0';
            }
        }

        // Draggable Logic
        let isDragging = false;
        let currentWindow = null;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;

        function startDrag(e, id) {
            const win = document.getElementById(id);
            currentWindow = win;
            
            // Bring to front
            win.style.zIndex = ++zIndex;

            // Check if maximized (disable drag if maximized)
            if(win.style.width === '100%') return;

            initialX = e.clientX - win.offsetLeft;
            initialY = e.clientY - win.offsetTop;

            isDragging = true;
        }

        function makeDraggable(el) {
           el.addEventListener('mousedown', function() {
               el.style.zIndex = ++zIndex;
           });
        }

        document.addEventListener('mousemove', function(e) {
            if (isDragging && currentWindow) {
                e.preventDefault();
                const currentX = e.clientX - initialX;
                const currentY = e.clientY - initialY;

                currentWindow.style.left = currentX + "px";
                currentWindow.style.top = currentY + "px";
            }
        });

        document.addEventListener('mouseup', function() {
            isDragging = false;
            currentWindow = null;
        });

        // App Logic: Terminal
        function handleTerminalCommand(id, cmd) {
            const history = document.getElementById(`history-${id}`);
            const output = document.createElement('div');
            output.innerHTML = `<div><span style="color:#0f0">root@webos:~$</span> ${cmd}</div>`;
            
            let response = "";
            const command = cmd.trim().toLowerCase();

            switch(command) {
                case 'help':
                    response = "Available commands: help, date, clear, echo [text], reboot, whoami";
                    break;
                case 'date':
                    response = new Date().toString();
                    break;
                case 'clear':
                    history.innerHTML = '';
                    return; // Don't append empty response
                case 'reboot':
                    location.reload();
                    break;
                case 'whoami':
                    response = "root";
                    break;
                default:
                    if(command.startsWith('echo ')) {
                        response = cmd.substring(5);
                    } else if (command === "") {
                        response = "";
                    } else {
                        response = `Command not found: ${command}`;
                    }
            }

            if(response) {
                output.innerHTML += `<div style="color:#ccc; margin-bottom:10px">${response}</div>`;
            }
            
            history.appendChild(output);
            const body = document.getElementById(`term-${id}`);
            body.scrollTop = body.scrollHeight;
        }

        // App Logic: Calculator
        function calcInput(id, val) {
            const display = document.getElementById(`calc-display-${id}`);
            if(val === 'C') {
                display.value = '';
            } else if (val === '=') {
                try {
                    display.value = eval(display.value);
                } catch {
                    display.value = 'Error';
                }
            } else {
                display.value += val;
            }
        }
    </script>
</body>
</html>
